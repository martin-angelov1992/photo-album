diff --git a/.classpath b/.classpath
index 67355ee..c2117c0 100644
--- a/.classpath
+++ b/.classpath
@@ -28,5 +28,6 @@
 	<classpathentry kind="lib" path="C:/my/derbyclient.jar"/>
 	<classpathentry kind="lib" path="C:/my/derbynet.jar"/>
 	<classpathentry kind="lib" path="C:/my/eclipselink.jar"/>
+	<classpathentry kind="lib" path="C:/my/jmagick.jar"/>
 	<classpathentry kind="output" path="target/classes"/>
 </classpath>
diff --git a/db.lck b/db.lck
index e117105..3d166b5 100644
Binary files a/db.lck and b/db.lck differ
diff --git a/db.log b/db.log
index b7167a5..c4ec66e 100644
--- a/db.log
+++ b/db.log
@@ -1,10 +1,81 @@
-/*C3*/SET SCHEMA PUBLIC
-INSERT INTO ACCOUNT VALUES(24,'eh@eh.com','eh','a8f5f167f44f4964e6c998dee827110c','eh')
-INSERT INTO CATEGORY VALUES(46,'eh',24,NULL)
+/*C1*/SET SCHEMA SYSTEM_LOBS
+INSERT INTO LOB_IDS VALUES(3,594347,0,30)
+COMMIT
+ALTER SEQUENCE SYSTEM_LOBS.LOB_ID RESTART WITH 4
+DELETE FROM BLOCKS WHERE BLOCK_ADDR=19
+INSERT INTO BLOCKS VALUES(19,19,0)
+INSERT INTO BLOCKS VALUES(38,2147483609,0)
+DELETE FROM BLOCKS WHERE BLOCK_ADDR=19
+INSERT INTO LOBS VALUES(19,19,0,3)
+COMMIT
+INSERT INTO LOB_IDS VALUES(4,0,0,30)
+COMMIT
+ALTER SEQUENCE SYSTEM_LOBS.LOB_ID RESTART WITH 5
+/*C5*/SET SCHEMA PUBLIC
+INSERT INTO PHOTO VALUES(2,'a','2017-08-24 05:31:12.936000','asd',3,4,NULL,NULL)
+INSERT INTO CATEGORY_PHOTO VALUES(1,2)
+SET SCHEMA SYSTEM_LOBS
+DELETE FROM LOB_IDS WHERE LOB_ID=3
+INSERT INTO LOB_IDS VALUES(3,594347,1,30)
+DELETE FROM LOB_IDS WHERE LOB_ID=4
+INSERT INTO LOB_IDS VALUES(4,0,1,30)
+COMMIT
+/*C1*/INSERT INTO LOB_IDS VALUES(5,594347,0,30)
+COMMIT
+ALTER SEQUENCE SYSTEM_LOBS.LOB_ID RESTART WITH 6
+DELETE FROM BLOCKS WHERE BLOCK_ADDR=38
+INSERT INTO BLOCKS VALUES(38,19,0)
+INSERT INTO BLOCKS VALUES(57,2147483590,0)
+DELETE FROM BLOCKS WHERE BLOCK_ADDR=38
+INSERT INTO LOBS VALUES(38,19,0,5)
+COMMIT
+INSERT INTO LOB_IDS VALUES(6,0,0,30)
+COMMIT
+ALTER SEQUENCE SYSTEM_LOBS.LOB_ID RESTART WITH 7
+/*C6*/SET SCHEMA PUBLIC
+INSERT INTO PHOTO VALUES(3,'a','2017-08-24 05:31:28.738000','asd',5,6,NULL,NULL)
+INSERT INTO CATEGORY_PHOTO VALUES(1,3)
+SET SCHEMA SYSTEM_LOBS
+DELETE FROM LOB_IDS WHERE LOB_ID=5
+INSERT INTO LOB_IDS VALUES(5,594347,1,30)
+DELETE FROM LOB_IDS WHERE LOB_ID=6
+INSERT INTO LOB_IDS VALUES(6,0,1,30)
+COMMIT
+/*C7*/SET SCHEMA PUBLIC
+INSERT INTO ACCOUNT VALUES(25,'asdasd@asd.com','asd','7555051b6d8a2dca27a29f9cb0d2e3a6','ccasd')
+INSERT INTO CATEGORY VALUES(47,'asd',25,NULL)
+COMMIT
+/*C5*/SET SCHEMA PUBLIC
+INSERT INTO CATEGORY VALUES(48,'asd',25,NULL)
+COMMIT
+DELETE FROM ACCOUNT WHERE ID=25
+INSERT INTO ACCOUNT VALUES(25,'asdasd@asd.com','asdd','7555051b6d8a2dca27a29f9cb0d2e3a6','ccasd')
+DELETE FROM CATEGORY WHERE ID=47
+INSERT INTO CATEGORY VALUES(47,'asdd',25,NULL)
 COMMIT
 /*C4*/SET SCHEMA PUBLIC
-DELETE FROM ACCOUNT WHERE ID=24
-INSERT INTO ACCOUNT VALUES(24,'ei@ei.com','ei','a8f5f167f44f4964e6c998dee827110c','eh')
-DELETE FROM CATEGORY WHERE ID=46
-INSERT INTO CATEGORY VALUES(46,'ei',24,NULL)
+DELETE FROM CATEGORY WHERE ID=48
+INSERT INTO CATEGORY VALUES(48,NULL,25,NULL)
+COMMIT
+INSERT INTO CATEGORY VALUES(49,'child\u000a',25,48)
+COMMIT
+/*C1*/INSERT INTO LOB_IDS VALUES(7,594347,0,30)
+COMMIT
+ALTER SEQUENCE SYSTEM_LOBS.LOB_ID RESTART WITH 8
+DELETE FROM BLOCKS WHERE BLOCK_ADDR=57
+INSERT INTO BLOCKS VALUES(57,19,0)
+INSERT INTO BLOCKS VALUES(76,2147483571,0)
+DELETE FROM BLOCKS WHERE BLOCK_ADDR=57
+INSERT INTO LOBS VALUES(57,19,0,7)
+COMMIT
+INSERT INTO LOB_IDS VALUES(8,0,0,30)
+COMMIT
+ALTER SEQUENCE SYSTEM_LOBS.LOB_ID RESTART WITH 9
+/*C7*/INSERT INTO PHOTO VALUES(4,'a','2017-08-24 10:00:43.382000','asd',7,8,NULL,NULL)
+INSERT INTO CATEGORY_PHOTO VALUES(1,4)
+SET SCHEMA SYSTEM_LOBS
+DELETE FROM LOB_IDS WHERE LOB_ID=7
+INSERT INTO LOB_IDS VALUES(7,594347,1,30)
+DELETE FROM LOB_IDS WHERE LOB_ID=8
+INSERT INTO LOB_IDS VALUES(8,0,1,30)
 COMMIT
diff --git a/db.properties b/db.properties
index 6687c20..0546ca9 100644
--- a/db.properties
+++ b/db.properties
@@ -1,4 +1,4 @@
 #HSQL Database Engine 2.3.0
-#Wed Aug 23 18:19:07 EEST 2017
+#Thu Aug 24 05:31:12 EEST 2017
 version=2.3.0
 modified=yes
diff --git a/db.script b/db.script
index 0fc4797..8da2066 100644
--- a/db.script
+++ b/db.script
@@ -34,15 +34,15 @@ ALTER USER SA SET LOCAL TRUE
 CREATE SCHEMA PUBLIC AUTHORIZATION DBA
 SET SCHEMA PUBLIC
 CREATE MEMORY TABLE PUBLIC.ACCOUNT(ID INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,MAIL VARCHAR(255),NAME VARCHAR(255),PASSHASH VARCHAR(255),USERNAME VARCHAR(255))
-ALTER TABLE PUBLIC.ACCOUNT ALTER COLUMN ID RESTART WITH 24
+ALTER TABLE PUBLIC.ACCOUNT ALTER COLUMN ID RESTART WITH 25
 CREATE MEMORY TABLE PUBLIC.PHOTO(ID INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,NAME VARCHAR(255),DATEADDED TIMESTAMP,DESCRIPTION VARCHAR(255),IMAGE BLOB(255),THUMBNAIL BLOB(255),OWNER_ID INTEGER,PARENT_ID INTEGER,CONSTRAINT FK4984E129419E012 FOREIGN KEY(OWNER_ID) REFERENCES PUBLIC.ACCOUNT(ID))
-ALTER TABLE PUBLIC.PHOTO ALTER COLUMN ID RESTART WITH 1
+ALTER TABLE PUBLIC.PHOTO ALTER COLUMN ID RESTART WITH 2
 CREATE MEMORY TABLE PUBLIC.CATEGORY(ID INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,NAME VARCHAR(255),OWNER_ID INTEGER,PARENT_ID INTEGER,CONSTRAINT FK6DD211E9419E012 FOREIGN KEY(OWNER_ID) REFERENCES PUBLIC.ACCOUNT(ID),CONSTRAINT FK6DD211EEBDBADD0 FOREIGN KEY(PARENT_ID) REFERENCES PUBLIC.CATEGORY(ID))
-ALTER TABLE PUBLIC.CATEGORY ALTER COLUMN ID RESTART WITH 46
+ALTER TABLE PUBLIC.CATEGORY ALTER COLUMN ID RESTART WITH 47
 CREATE MEMORY TABLE PUBLIC.CATEGORY_CATEGORY(CATEGORY_ID INTEGER NOT NULL,SUBCATEGORIES_ID INTEGER NOT NULL,PRIMARY KEY(CATEGORY_ID,SUBCATEGORIES_ID),CONSTRAINT FK8635931F46638CDE FOREIGN KEY(SUBCATEGORIES_ID) REFERENCES PUBLIC.CATEGORY(ID),CONSTRAINT FK8635931FCC1DA8FC FOREIGN KEY(CATEGORY_ID) REFERENCES PUBLIC.CATEGORY(ID))
 CREATE MEMORY TABLE PUBLIC.CATEGORY_PHOTO(CATEGORY_ID INTEGER NOT NULL,PHOTOS_ID INTEGER NOT NULL,PRIMARY KEY(CATEGORY_ID,PHOTOS_ID),CONSTRAINT FK347003B1FA95B09 FOREIGN KEY(PHOTOS_ID) REFERENCES PUBLIC.PHOTO(ID),CONSTRAINT FK347003B1CC1DA8FC FOREIGN KEY(CATEGORY_ID) REFERENCES PUBLIC.CATEGORY(ID))
 ALTER TABLE PUBLIC.PHOTO ADD CONSTRAINT FK4984E12EBDBADD0 FOREIGN KEY(PARENT_ID) REFERENCES PUBLIC.CATEGORY(ID)
-ALTER SEQUENCE SYSTEM_LOBS.LOB_ID RESTART WITH 1
+ALTER SEQUENCE SYSTEM_LOBS.LOB_ID RESTART WITH 3
 SET DATABASE DEFAULT INITIAL SCHEMA PUBLIC
 GRANT USAGE ON DOMAIN INFORMATION_SCHEMA.SQL_IDENTIFIER TO PUBLIC
 GRANT USAGE ON DOMAIN INFORMATION_SCHEMA.YES_OR_NO TO PUBLIC
@@ -51,7 +51,10 @@ GRANT USAGE ON DOMAIN INFORMATION_SCHEMA.CARDINAL_NUMBER TO PUBLIC
 GRANT USAGE ON DOMAIN INFORMATION_SCHEMA.CHARACTER_DATA TO PUBLIC
 GRANT DBA TO SA
 SET SCHEMA SYSTEM_LOBS
-INSERT INTO BLOCKS VALUES(0,2147483647,0)
+INSERT INTO BLOCKS VALUES(19,2147483628,0)
+INSERT INTO LOBS VALUES(0,19,0,1)
+INSERT INTO LOB_IDS VALUES(1,594347,1,30)
+INSERT INTO LOB_IDS VALUES(2,0,1,30)
 SET SCHEMA PUBLIC
 INSERT INTO ACCOUNT VALUES(1,NULL,NULL,NULL,NULL)
 INSERT INTO ACCOUNT VALUES(2,NULL,NULL,NULL,NULL)
@@ -76,6 +79,8 @@ INSERT INTO ACCOUNT VALUES(20,'de@de.com','de','a8f5f167f44f4964e6c998dee827110c
 INSERT INTO ACCOUNT VALUES(21,'ef@ef.com','ef','a8f5f167f44f4964e6c998dee827110c','ef')
 INSERT INTO ACCOUNT VALUES(22,'ea@ea.com','eb','a8f5f167f44f4964e6c998dee827110c','ea')
 INSERT INTO ACCOUNT VALUES(23,'ec@ea.com','ed','a8f5f167f44f4964e6c998dee827110c','ec')
+INSERT INTO ACCOUNT VALUES(24,'ei@ei.com','ei','a8f5f167f44f4964e6c998dee827110c','eh')
+INSERT INTO PHOTO VALUES(1,'a','2017-08-24 05:19:49.566000','asd',1,2,NULL,NULL)
 INSERT INTO CATEGORY VALUES(1,'{name:"asd"}',NULL,NULL)
 INSERT INTO CATEGORY VALUES(2,'{name:"asd"}',NULL,NULL)
 INSERT INTO CATEGORY VALUES(3,'{name:"asd"}',NULL,NULL)
@@ -120,3 +125,5 @@ INSERT INTO CATEGORY VALUES(42,'de',NULL,NULL)
 INSERT INTO CATEGORY VALUES(43,'ef',20,NULL)
 INSERT INTO CATEGORY VALUES(44,'eb',22,NULL)
 INSERT INTO CATEGORY VALUES(45,'ed',23,NULL)
+INSERT INTO CATEGORY VALUES(46,'ei',24,NULL)
+INSERT INTO CATEGORY_PHOTO VALUES(1,1)
diff --git a/pom.xml b/pom.xml
index 78c24de..0047377 100644
--- a/pom.xml
+++ b/pom.xml
@@ -25,11 +25,10 @@
 		</dependencies>
 	</dependencyManagement>
 	<dependencies>
-		<dependency>
-			<groupId>com.sun.jersey.contribs</groupId>
-			<artifactId>jersey-multipart</artifactId>
-			<version>1.8</version>
-		</dependency>
+<dependency>
+    <groupId>org.glassfish.jersey.media</groupId>
+    <artifactId>jersey-media-multipart</artifactId>
+</dependency>
 		<dependency>
 			<groupId>org.eclipse.jetty</groupId>
 			<artifactId>jetty-server</artifactId>
diff --git a/src/main/java/com/martin/photoAlbum/App.java b/src/main/java/com/martin/photoAlbum/App.java
index 990d7d1..83890af 100644
--- a/src/main/java/com/martin/photoAlbum/App.java
+++ b/src/main/java/com/martin/photoAlbum/App.java
@@ -19,6 +19,7 @@ public class App
         HashSessionManager manager = new HashSessionManager();
         SessionHandler sessions = new SessionHandler(manager);
         ResourceConfig config = new ResourceConfig();
+        config.register(org.glassfish.jersey.media.multipart.MultiPartFeature.class);
         config.packages("com.martin.photoAlbum.requesthandlers");
         ServletHolder servlet = new MyServletHolder(new ServletContainer(config));
 
diff --git a/src/main/java/com/martin/photoAlbum/business/PhotoService.java b/src/main/java/com/martin/photoAlbum/business/PhotoService.java
index 7d2e156..802a208 100644
--- a/src/main/java/com/martin/photoAlbum/business/PhotoService.java
+++ b/src/main/java/com/martin/photoAlbum/business/PhotoService.java
@@ -42,13 +42,32 @@ public class PhotoService extends Service {
 
 	}
 
-	public enum AddResult {
-		NOT_LOGGED_IN, CATEGORY_DOES_NOT_EXIST, OK
+	public static class AddResult {
+		public enum Status {NOT_LOGGED_IN, CATEGORY_DOES_NOT_EXIST, OK}
+		
+		private Status status;
+		private int id;
+		
+		public AddResult(Status status) {
+			this.status = status;
+		}
+		
+		public void setId(int id) {
+			this.id = id;
+		}
+
+		public Status getStatus() {
+			return status;
+		}
+
+		public int getId() {
+			return id;
+		}		
 	}
 	
 	public AddResult add(int categoryID, String name, String description, byte[] photoContent) {
 		if (!session.isLoggedIn()) {
-			return AddResult.NOT_LOGGED_IN;
+			return new AddResult(AddResult.Status.NOT_LOGGED_IN);
 		}
 		
 		EntityManager em = Data.getInstance().getEntityManager();
@@ -56,10 +75,10 @@ public class PhotoService extends Service {
 		Category category = em.find(Category.class, categoryID);
 		
 		if (category == null) {
-			return AddResult.CATEGORY_DOES_NOT_EXIST;
+			return new AddResult(AddResult.Status.CATEGORY_DOES_NOT_EXIST);
 		}
 		
-		byte[] thumbnailBytes = generateThumbnail(photoContent);
+		byte[] thumbnailBytes = new byte[0];//generateThumbnail(photoContent);
 		
 		Photo photo = new Photo();
 		photo.setDateAdded(new Date());
@@ -74,7 +93,10 @@ public class PhotoService extends Service {
 		
 		em.persist(category);
 		
-		return AddResult.OK;
+		AddResult result = new AddResult(AddResult.Status.OK);
+		result.setId(photo.getId());
+		
+		return result;
 	}
 	
 	private byte[] generateThumbnail(byte[] photoContent) {
diff --git a/src/main/java/com/martin/photoAlbum/requesthandlers/PhotoApiService.java b/src/main/java/com/martin/photoAlbum/requesthandlers/PhotoApiService.java
index 900b270..6aab8dd 100644
--- a/src/main/java/com/martin/photoAlbum/requesthandlers/PhotoApiService.java
+++ b/src/main/java/com/martin/photoAlbum/requesthandlers/PhotoApiService.java
@@ -5,18 +5,19 @@ import java.io.InputStream;
 
 import javax.ws.rs.Consumes;
 import javax.ws.rs.DELETE;
+import javax.ws.rs.FormParam;
 import javax.ws.rs.POST;
 import javax.ws.rs.PUT;
 import javax.ws.rs.Path;
+import javax.ws.rs.PathParam;
 import javax.ws.rs.core.MediaType;
 import javax.ws.rs.core.Response;
 
 import org.apache.commons.io.IOUtils;
+import org.glassfish.jersey.media.multipart.FormDataParam;
 
 import com.martin.photoAlbum.business.PhotoService;
 import com.martin.photoAlbum.business.PhotoService.AddResult;
-import com.sun.jersey.core.header.FormDataContentDisposition;
-import com.sun.jersey.multipart.FormDataParam;
 
 @Path("/manage-photo")
 public class PhotoApiService extends ApiService<PhotoService> {
@@ -31,9 +32,10 @@ public class PhotoApiService extends ApiService<PhotoService> {
 
 	@POST
 	@Consumes(MediaType.MULTIPART_FORM_DATA)
-	public Response add(int categoryID, String name, String description, 
-			@FormDataParam("file") InputStream uploadedInputStream,
-			@FormDataParam("file") FormDataContentDisposition fileDetail) {
+	public Response add(@FormDataParam("categoryID") int categoryID, 
+			@FormDataParam("name") String name, 
+			@FormDataParam("description") String description, 
+			@FormDataParam("file") InputStream uploadedInputStream) {
 		updateSession();
 		
 		AddResult result;
@@ -45,15 +47,18 @@ public class PhotoApiService extends ApiService<PhotoService> {
 			return Response.status(500).build();
 		}
 		
-		if (result != AddResult.OK) {
+		if (result.getStatus() != AddResult.Status.OK) {
 			return Response.status(403).entity(result).build();
 		}
 		
-		return Response.ok().build();
+		return Response.ok().entity(result.getId()).build();
 	}
 	
 	@PUT
-	public Response edit(int id, String name, String description) {
+	@Path("/{id}")
+	public Response edit(@PathParam("id") int id, 
+			@FormParam("name") String name, 
+			@FormParam("description") String description) {
 		updateSession();
 		
 		service.edit(id, name, description);
@@ -61,7 +66,8 @@ public class PhotoApiService extends ApiService<PhotoService> {
 	}
 	
 	@DELETE
-	public Response delete(int id) {
+	@Path("/{id}")
+	public Response delete(@PathParam("id") int id) {
 		updateSession();
 		return null;
 	}
diff --git a/target/classes/com/martin/photoAlbum/App.class b/target/classes/com/martin/photoAlbum/App.class
index 883d2f2..d5c8944 100644
Binary files a/target/classes/com/martin/photoAlbum/App.class and b/target/classes/com/martin/photoAlbum/App.class differ
